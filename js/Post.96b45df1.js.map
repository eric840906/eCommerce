{"version":3,"sources":["webpack:///./src/views/Dashboard/Post.vue","webpack:///./src/components/Card.vue","webpack:///./src/components/Card.vue?6747","webpack:///./src/components/Card.vue?e156","webpack:///./src/views/Dashboard/Post.vue?5c19","webpack:///./src/views/Dashboard/Post.vue?8278","webpack:///./src/views/Dashboard/Post.vue?ab08","webpack:///./src/components/Card.vue?85f2"],"names":["class","for","id","recentPosts","data","length","item","_id","card","newPost","postData","title","category","article","type","accept","style","uploadToImgur","imageThumb","src","alt","otherShow","name","uploadOthers","putImage","$event","photo","editPost","components","Button","props","Object","required","setup","router","push","render","__scopeId","Card","store","toast","images","otherImages","imageName","updateIndex","indexOf","filter","bus","on","e","index","target","files","file","value","window","URL","createObjectURL","form","FormData","append","status","success","link","error","info","undefined","Promise","all","map","image","imgArr","img","getPosts","dispatch","res","state"],"mappings":"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","file":"js/Post.96b45df1.js","sourcesContent":["<template>\r\n  <div class=\"w-100 d-flex p-3 m-md-2 flex-column flex-md-row dashboard-morph user-row flex-grow-1 dashboard-morph user-row\">\r\n    <div class=\"align-items-center text-start flex-column w-100\">\r\n      <div class=\"title w-100 d-flex\">\r\n        <h5 class=\"fw-bolder text-uppercase\">Recent Posts</h5>\r\n        <Button class=\"ml-auto\">Show all</Button>\r\n      </div>\r\n      <div class=\"posts-container d-flex overflow-auto w-100 py-3\">\r\n        <p v-if=\"recentPosts.data.length === 0\" class=\"text-uppercase m-auto\">Currently nothing here</p>\r\n        <template v-for=\"item in recentPosts.data\" :key=\"item._id\">\r\n          <Card :card=\"item\"></Card>\r\n        </template>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"d-flex flex-grow-1\">\r\n    <div class=\"col text-start\">\r\n      <form class=\"p-3 m-2 dashboard-morph\" @submit.prevent=\"newPost\">\r\n        <div class=\"title w-100 d-flex\">\r\n          <h5 class=\"fw-bolder text-uppercase\">Make new post</h5>\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"post-title\">Post title</label>\r\n          <input\r\n            class=\"form-control\"\r\n            id=\"post-title\"\r\n            v-model=\"postData.title\"\r\n          />\r\n        </div>\r\n        <div class=\"form-group my-2 d-flex flex-column\">\r\n          <label>Category</label>\r\n          <select class=\"custom-select custom-select-sm\" v-model=\"postData.category\">\r\n            <option selected value=\"Other\">Other</option>\r\n            <option value=\"News\">News</option>\r\n            <option value=\"Cakes\">Cakes</option>\r\n            <option value=\"Cookies\">Cookies</option>\r\n            <option value=\"Tips\">Tips</option>\r\n          </select>\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"user-desc\">Article</label>\r\n          <textarea\r\n            class=\"form-control\"\r\n            id=\"user-desc\"\r\n            v-model=\"postData.article\"\r\n          />\r\n          <small id=\"nameHelp\" class=\"form-text text-muted\"\r\n            >Enter some words to introduce yourself</small\r\n          >\r\n        </div>\r\n        <div class=\"form-group my-2\">\r\n          <Button><label for=\"photo\">Upload cover image</label></Button>\r\n          <input\r\n            type=\"file\"\r\n            class=\"form-control\"\r\n            id=\"photo\"\r\n            accept=\"image/*\"\r\n            style=\"display:none\"\r\n            @change.prevent=\"uploadToImgur\"\r\n          />\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <img style=\"max-height: 300px;\" v-if=\"imageThumb\" :src=\"imageThumb\" alt=\"\">\r\n        </div>\r\n        <div class=\"form-group my-2\">\r\n          <Button @click=\"otherShow = !otherShow\">Upload other images</Button>\r\n        </div>\r\n        <transition name=\"top-show\">\r\n          <form class=\"form-group my-2\" v-show=\"otherShow\" @submit.prevent=\"uploadOthers\">\r\n            <input class=\"custom-file-input\" type=\"file\" name=\"image0\" id=\"image0\" @change=\"putImage($event, 0)\">\r\n            <input class=\"custom-file-input\" type=\"file\" name=\"image1\" id=\"image1\" @change=\"putImage($event, 1)\">\r\n            <input class=\"custom-file-input\" type=\"file\" name=\"image2\" id=\"image2\" @change=\"putImage($event, 2)\">\r\n            <input class=\"custom-file-input\" type=\"file\" name=\"image3\" id=\"image3\" @change=\"putImage($event, 3)\">\r\n            <input class=\"custom-file-input\" type=\"file\" name=\"image4\" id=\"image4\" @change=\"putImage($event, 4)\">\r\n            <div class=\"form-group my-2\">\r\n              <Button class=\"ml-auto\" type=\"submit\">Upload them all</Button>\r\n            </div>\r\n          </form>\r\n        </transition>\r\n        <!-- <div class=\"form-group\">\r\n          <label for=\"user-image\"\r\n            >Select a new profile pic</label\r\n          >\r\n          <input\r\n            type=\"file\"\r\n            class=\"form-control-file display-none\"\r\n            id=\"exampleFormControlFile1\"\r\n          />\r\n        </div> -->\r\n        <div class=\"form-group d-flex\">\r\n          <Button class=\"ml-auto\" type=\"submit\">Make a new post</Button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\">\r\nimport { defineComponent, reactive, ref } from 'vue'\r\nimport { imageUpload, postNewPost, getContent } from '@/api'\r\nimport { useStore } from 'vuex'\r\nimport axios from 'axios'\r\nimport Button from '@/components/btn.vue'\r\nimport Card from '@/components/Card.vue'\r\nimport bus from '@/plugins/bus'\r\nimport { useToast } from 'vue-toastification'\r\nexport interface HTMLInputEvent extends Event {\r\n    target: HTMLInputElement & EventTarget;\r\n}\r\nexport interface Post {\r\n  title: string;\r\n  article: string;\r\n  photo: string;\r\n  images?: string[];\r\n  category: string;\r\n  _id?: string;\r\n  id?: string;\r\n}\r\nexport default defineComponent({\r\n  name: 'Post',\r\n  components: {\r\n    Button,\r\n    Card\r\n  },\r\n  setup () {\r\n    const store = useStore()\r\n    const toast = useToast()\r\n    const postData = reactive<Post>({\r\n      title: '',\r\n      article: '',\r\n      photo: '',\r\n      images: [],\r\n      category: ''\r\n    })\r\n    const otherImages = reactive({ images: [] as File[] })\r\n    const recentPosts = reactive({ data: [] as Post[] })\r\n    const imageName = ref('')\r\n    const imageThumb = ref('')\r\n    const category = ref('')\r\n    const otherShow = ref(false)\r\n    const updateIndex = (id: string) => {\r\n      return (recentPosts.data.indexOf(recentPosts.data.filter((item: Post) => item.id === id)[0]))\r\n    }\r\n    bus.on('update-open', (id) => updateIndex(id))\r\n    const putImage = (e: HTMLInputEvent, index: number) => {\r\n      if (!e.target.files) return\r\n      otherImages.images.length = 5\r\n      otherImages.images[index] = e.target.files[0]\r\n    }\r\n    const uploadToImgur = async (e: HTMLInputEvent) => {\r\n      try {\r\n        if (!e.target.files) return\r\n        const file: File = e.target.files[0]\r\n        imageName.value = file.name\r\n        imageThumb.value = window.URL.createObjectURL(file)\r\n        const form: FormData = new FormData()\r\n        form.append('title', imageName.value)\r\n        form.append('image', file)\r\n        const { data } = await imageUpload(form)\r\n        if (data.status === 200) {\r\n          toast.success('image uploaded successfully')\r\n          postData.photo = data.data.link\r\n        }\r\n      } catch (error) {\r\n        toast.error('OPPS! something wrong during the process')\r\n      }\r\n    }\r\n    const uploadOthers = async () => {\r\n      try {\r\n        toast.info('Start uploading, it might take some time')\r\n        otherImages.images = otherImages.images.filter(item => item !== undefined)\r\n        const imgArr = await Promise.all(otherImages.images.map(image => {\r\n          const form = new FormData()\r\n          form.append('image', image)\r\n          return imageUpload(form)\r\n        }))\r\n        if (imgArr[imgArr.length - 1].status === 200) {\r\n          toast.success(`${imgArr.length} images uploaded successfully`)\r\n          otherImages.images.length = 0\r\n        }\r\n        postData.images = imgArr.map(img => img.data.data.link)\r\n      } catch (error) {\r\n        toast.error('OPPS! something wrong during the process')\r\n      }\r\n    }\r\n    const getPosts = async () => {\r\n      try {\r\n        store.dispatch('loading')\r\n        const res = await getContent(1, 5)\r\n        recentPosts.data = res.data.data\r\n        if (res.data.state === 'success') {\r\n          store.dispatch('loading')\r\n        }\r\n      } catch (error) {\r\n        toast.error('error')\r\n        store.dispatch('loading')\r\n      }\r\n    }\r\n    const newPost = async () => {\r\n      try {\r\n        store.dispatch('loading')\r\n        const res = await postNewPost(postData)\r\n        if (res.status === 201) {\r\n          await toast.success('New article posted')\r\n          store.dispatch('loading')\r\n          postData.title = ''\r\n          postData.article = ''\r\n          postData.photo = ''\r\n          imageThumb.value = ''\r\n          getPosts()\r\n        }\r\n      } catch (error) {\r\n        store.dispatch('loading')\r\n        toast.error('An error occurred while posting')\r\n      }\r\n    }\r\n    getPosts()\r\n    return {\r\n      uploadToImgur,\r\n      imageName,\r\n      imageThumb,\r\n      postData,\r\n      newPost,\r\n      recentPosts,\r\n      otherShow,\r\n      uploadOthers,\r\n      otherImages,\r\n      putImage,\r\n      category\r\n      // title,\r\n      // description\r\n    }\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.account-icon {\r\n  width: 20px;\r\n}\r\n.active {\r\n  background-color: #ffffffc4;\r\n}\r\n\r\n.view-window {\r\n  overflow: auto;\r\n  height: 80vh;\r\n}\r\n.image-block {\r\n  position: relative;\r\n  .user-image {\r\n    border-radius: 100%;\r\n    width: 200px;\r\n    height: 200px;\r\n  }\r\n  .image-btn {\r\n    cursor: pointer;\r\n    position: absolute;\r\n    bottom: 15%;\r\n    right: 0%;\r\n    border: none;\r\n    background: #ffffff69;\r\n    box-shadow: 0px 0px 2px black;\r\n    border-radius: 100%;\r\n    height: 35px;\r\n    width: 35px;\r\n    transition: all 0.5s ease;\r\n    &:hover {\r\n      box-shadow: 0px 0px 5px black;\r\n    }\r\n    .camera-icon {\r\n      position: absolute;\r\n      top: 50%;\r\n      left: 50%;\r\n      transform: translate(-50%, -50%);\r\n    }\r\n  }\r\n}\r\n.user-row {\r\n  position: relative;\r\n}\r\n.user-role-tag {\r\n  border-radius: 0 0 0px 10px;\r\n  text-transform: uppercase;\r\n  position: absolute;\r\n  width: 100px;\r\n  right: 0px;\r\n  top: 0;\r\n}\r\n.user-color {\r\n  background-color: #1693e94a;\r\n}\r\n.admin-color {\r\n  background-color: #e916164a;\r\n}\r\n\r\n.user-info {\r\n  padding-left: 1rem;\r\n}\r\n.top-show-enter-from, .top-show-leave-to {\r\n  transform: scaleY(0);\r\n  opacity: 0;\r\n}\r\n.top-show-enter-to, .top-show-leave-from {\r\n  transform: scaleY(1);\r\n  opacity: 1;\r\n}\r\n.top-show-enter-active, .top-show-leave-active {\r\n  transition: all 0.5s ease;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"px-3\">\r\n    <div class=\"card\" style=\"width: 18rem;\">\r\n      <img :src=\"card.photo\" class=\"card-img-top\" alt=\"...\">\r\n      <div class=\"card-body d-flex flex-column\">\r\n        <h5 class=\"card-title text-capitalize fw-bolder\">{{card.title}}</h5>\r\n        <p class=\"card-text\">{{card.article}}</p>\r\n        <Button class=\"ml-auto\" style=\"margin-top: auto;\" type=\"submit\" @click=\"editPost(card._id)\">Edit this post</Button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\">\r\nimport { defineComponent, PropType } from 'vue'\r\nimport Button from '@/components/btn.vue'\r\nimport { useRouter } from 'vue-router'\r\nexport interface CardProps {\r\n  _id: string;\r\n  title: string;\r\n  photo: string;\r\n  article: string;\r\n};\r\nexport default defineComponent({\r\n  components: {\r\n    Button\r\n  },\r\n  props: {\r\n    card: {\r\n      type: Object as PropType<CardProps>,\r\n      required: true\r\n    }\r\n  },\r\n  setup () {\r\n    const router = useRouter()\r\n    const editPost = (id: string) => {\r\n      router.push(`/update/${id}`)\r\n    }\r\n    return {\r\n      editPost\r\n    }\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.card {\r\n  border-radius: 10px;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  backdrop-filter: blur(3px);\r\n  background-color: transparent;\r\n  border: none;\r\n  box-shadow: 0px 0px 9px #0000005e;\r\n  .card-img-top {\r\n    height: 300px;\r\n    object-fit: cover;\r\n  }\r\n  .card-text {\r\n    height: 5rem;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  }\r\n}\r\n</style>\r\n","\r\nimport { defineComponent, PropType } from 'vue'\r\nimport Button from '@/components/btn.vue'\r\nimport { useRouter } from 'vue-router'\r\nexport interface CardProps {\r\n  _id: string;\r\n  title: string;\r\n  photo: string;\r\n  article: string;\r\n};\r\nexport default defineComponent({\r\n  components: {\r\n    Button\r\n  },\r\n  props: {\r\n    card: {\r\n      type: Object as PropType<CardProps>,\r\n      required: true\r\n    }\r\n  },\r\n  setup () {\r\n    const router = useRouter()\r\n    const editPost = (id: string) => {\r\n      router.push(`/update/${id}`)\r\n    }\r\n    return {\r\n      editPost\r\n    }\r\n  }\r\n})\r\n","import { render } from \"./Card.vue?vue&type=template&id=8bdcae64&scoped=true\"\nimport script from \"./Card.vue?vue&type=script&lang=ts\"\nexport * from \"./Card.vue?vue&type=script&lang=ts\"\n\nimport \"./Card.vue?vue&type=style&index=0&id=8bdcae64&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-8bdcae64\"\n\nexport default script","\r\nimport { defineComponent, reactive, ref } from 'vue'\r\nimport { imageUpload, postNewPost, getContent } from '@/api'\r\nimport { useStore } from 'vuex'\r\nimport axios from 'axios'\r\nimport Button from '@/components/btn.vue'\r\nimport Card from '@/components/Card.vue'\r\nimport bus from '@/plugins/bus'\r\nimport { useToast } from 'vue-toastification'\r\nexport interface HTMLInputEvent extends Event {\r\n    target: HTMLInputElement & EventTarget;\r\n}\r\nexport interface Post {\r\n  title: string;\r\n  article: string;\r\n  photo: string;\r\n  images?: string[];\r\n  category: string;\r\n  _id?: string;\r\n  id?: string;\r\n}\r\nexport default defineComponent({\r\n  name: 'Post',\r\n  components: {\r\n    Button,\r\n    Card\r\n  },\r\n  setup () {\r\n    const store = useStore()\r\n    const toast = useToast()\r\n    const postData = reactive<Post>({\r\n      title: '',\r\n      article: '',\r\n      photo: '',\r\n      images: [],\r\n      category: ''\r\n    })\r\n    const otherImages = reactive({ images: [] as File[] })\r\n    const recentPosts = reactive({ data: [] as Post[] })\r\n    const imageName = ref('')\r\n    const imageThumb = ref('')\r\n    const category = ref('')\r\n    const otherShow = ref(false)\r\n    const updateIndex = (id: string) => {\r\n      return (recentPosts.data.indexOf(recentPosts.data.filter((item: Post) => item.id === id)[0]))\r\n    }\r\n    bus.on('update-open', (id) => updateIndex(id))\r\n    const putImage = (e: HTMLInputEvent, index: number) => {\r\n      if (!e.target.files) return\r\n      otherImages.images.length = 5\r\n      otherImages.images[index] = e.target.files[0]\r\n    }\r\n    const uploadToImgur = async (e: HTMLInputEvent) => {\r\n      try {\r\n        if (!e.target.files) return\r\n        const file: File = e.target.files[0]\r\n        imageName.value = file.name\r\n        imageThumb.value = window.URL.createObjectURL(file)\r\n        const form: FormData = new FormData()\r\n        form.append('title', imageName.value)\r\n        form.append('image', file)\r\n        const { data } = await imageUpload(form)\r\n        if (data.status === 200) {\r\n          toast.success('image uploaded successfully')\r\n          postData.photo = data.data.link\r\n        }\r\n      } catch (error) {\r\n        toast.error('OPPS! something wrong during the process')\r\n      }\r\n    }\r\n    const uploadOthers = async () => {\r\n      try {\r\n        toast.info('Start uploading, it might take some time')\r\n        otherImages.images = otherImages.images.filter(item => item !== undefined)\r\n        const imgArr = await Promise.all(otherImages.images.map(image => {\r\n          const form = new FormData()\r\n          form.append('image', image)\r\n          return imageUpload(form)\r\n        }))\r\n        if (imgArr[imgArr.length - 1].status === 200) {\r\n          toast.success(`${imgArr.length} images uploaded successfully`)\r\n          otherImages.images.length = 0\r\n        }\r\n        postData.images = imgArr.map(img => img.data.data.link)\r\n      } catch (error) {\r\n        toast.error('OPPS! something wrong during the process')\r\n      }\r\n    }\r\n    const getPosts = async () => {\r\n      try {\r\n        store.dispatch('loading')\r\n        const res = await getContent(1, 5)\r\n        recentPosts.data = res.data.data\r\n        if (res.data.state === 'success') {\r\n          store.dispatch('loading')\r\n        }\r\n      } catch (error) {\r\n        toast.error('error')\r\n        store.dispatch('loading')\r\n      }\r\n    }\r\n    const newPost = async () => {\r\n      try {\r\n        store.dispatch('loading')\r\n        const res = await postNewPost(postData)\r\n        if (res.status === 201) {\r\n          await toast.success('New article posted')\r\n          store.dispatch('loading')\r\n          postData.title = ''\r\n          postData.article = ''\r\n          postData.photo = ''\r\n          imageThumb.value = ''\r\n          getPosts()\r\n        }\r\n      } catch (error) {\r\n        store.dispatch('loading')\r\n        toast.error('An error occurred while posting')\r\n      }\r\n    }\r\n    getPosts()\r\n    return {\r\n      uploadToImgur,\r\n      imageName,\r\n      imageThumb,\r\n      postData,\r\n      newPost,\r\n      recentPosts,\r\n      otherShow,\r\n      uploadOthers,\r\n      otherImages,\r\n      putImage,\r\n      category\r\n      // title,\r\n      // description\r\n    }\r\n  }\r\n})\r\n","import { render } from \"./Post.vue?vue&type=template&id=0279b4b0&scoped=true\"\nimport script from \"./Post.vue?vue&type=script&lang=ts\"\nexport * from \"./Post.vue?vue&type=script&lang=ts\"\n\nimport \"./Post.vue?vue&type=style&index=0&id=0279b4b0&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-0279b4b0\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Post.vue?vue&type=style&index=0&id=0279b4b0&lang=scss&scoped=true\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Card.vue?vue&type=style&index=0&id=8bdcae64&lang=scss&scoped=true\""],"sourceRoot":""}